<!DOCTYPE html>
<html>
	<head>
		<title>memcpy.io | Running Android and Wayland on Embedded Devices</title>
		<link rel="icon" type="image/png" href="/favicon.png" />
		<link rel="stylesheet" type="text/css" href="/theme/css/fonts.css">
		<link rel="stylesheet" type="text/css" href="/theme/css/math.css">
		<link href="https://fonts.googleapis.com/css?family=Maven+Pro" rel="stylesheet">
		<link rel="canonical" href="https://memcpy.io/running-android-and-wayland-on-embedded-devices.html">
		<link rel="stylesheet" type="text/css" href="/theme/css/page.css">
		<meta charset="utf-8">
		<meta name="robots" content="index,follow">
		<meta name="viewport" content="width=device-width, initial-scale=1"> <!-- TODO: is this still required in 2015? -->
		<meta name="description" content="A previous post introduced the SPURV Android compatibility layer for Wayland based Linux environment. In this post we&#39;re going to dig into how you can run an Android application on the very common i.MX6 based Nitrogen6_MAX board from Boundary Devices. Install dependencies sudo apt install \ apt-transport-https \ bmap-tools \ ca-certificates \ curl \ git \ gnupg2 \ repo \ software-properties-common \ u-boot-tools \ qemu-kvm Set up Docker container for building # Install Docker curl -fsSL https://download.docker.com/linux/debian/gpg | sudo apt-key add - sudo add-apt-repository &#34;deb [arch=amd64] https://download.docker.com/linux/debian $(lsb_release -cs) stable&#34; sudo apt update sudo apt install docker-ce # Set up privileges for Docker sudo usermod -aG docker ${USER} su - ${USER} # Fetch Docker image docker pull godebos/debos:latest Build Build Android mkdir android; cd android repo â€¦">
		<meta name="author" content="Robert Foss">
		<meta name="keywords" content="Robert Foss memcpy Robert Foss, Open Source, Software, Linux, Embedded, Engineer, linux, open source, graphics, wayland, android, 3d, acceleration, imx6, nitrogen6">
		<meta property="og:title" content="Running Android and Wayland on Embedded Devices" />
		<meta property="og:type" content="article" />
		<meta property="og:url" content="https://memcpy.io/running-android-and-wayland-on-embedded-devices.html" />
		<meta property="og:locale" content="" />
		<meta property="og:site_name" content="memcpy.io" />
		<meta property="article:published_time" content="2019-05-03" />
		<meta property="article:section" content="android" />
		<meta property="article:tag" content="linux" />
		<meta property="article:tag" content="open source" />
		<meta property="article:tag" content="graphics" />
		<meta property="article:tag" content="wayland" />
		<meta property="article:tag" content="android" />
		<meta property="article:tag" content="3d" />
		<meta property="article:tag" content="acceleration" />
		<meta property="article:tag" content="imx6" />
		<meta property="article:tag" content="nitrogen6" />
		<meta name="twitter:card" content="summary_large_image" />
		<meta name="twitter:creator" content="@memcpy_io" />
		<meta name="twitter:site" content="@memcpy_io" />
		<meta name="twitter:title" content="Running Android and Wayland on Embedded Devices" />
		<meta name="twitter:description" content="Let&#39;s get Android running next to Wayland on an i.MX6 based Nitrogen6_MAX board." />
	</head>
	<body>
		<article id="content" itemscope>
			<header>
				<h1>Running Android and Wayland on Embedded Devices</h1>
				<p>
				Published <time datetime="2019-05-03" itemprop="datePublished">2019-05-03</time>
				</p>
			</header>
			<p>Let's get Android running next to Wayland on an i.MX6 based Nitrogen6_MAX board.</p>
			<p><a href="/running-android-next-to-wayland.html">A previous post</a> introduced the <a href="https://gitlab.collabora.com/spurv/device_freedesktop/blob/master/spurv/">SPURV</a>
Android compatibility layer for Wayland based Linux environment.<br>
In this post we're going to dig into how you can run an Android application
on the very common i.MX6 based <a href="https://boundarydevices.com/product/nitrogen6max/">Nitrogen6_MAX</a>
board from <a href="https://boundarydevices.com/">Boundary Devices</a>.</p>
<h2>Install dependencies</h2>
<div class="highlight"><pre><span></span><code><span class="err">sudo apt install \</span>
<span class="err">    apt-transport-https \</span>
<span class="err">    bmap-tools \</span>
<span class="err">    ca-certificates \</span>
<span class="err">    curl \</span>
<span class="err">    git \</span>
<span class="err">    gnupg2 \</span>
<span class="err">    repo \</span>
<span class="err">    software-properties-common \</span>
<span class="err">    u-boot-tools \</span>
<span class="err">    qemu-kvm</span>
</code></pre></div>

<h2>Set up Docker container for building</h2>
<div class="highlight"><pre><span></span><code># Install Docker
curl -fsSL https://download.docker.com/linux/debian/gpg | sudo apt-key add -
sudo add-apt-repository &quot;deb [arch=amd64] https://download.docker.com/linux/debian $(lsb_release -cs) stable&quot;
sudo apt update
sudo apt install docker-ce

# Set up privileges for Docker
sudo usermod -aG docker <span class="cp">${</span><span class="n">USER</span><span class="cp">}</span>
su - <span class="cp">${</span><span class="n">USER</span><span class="cp">}</span>

# Fetch Docker image
docker pull godebos/debos:latest
</code></pre></div>

<h2>Build</h2>
<h3>Build Android</h3>
<div class="highlight"><pre><span></span><code><span class="err">mkdir android; cd android</span>
<span class="err">repo init -u https://android.googlesource.com/platform/manifest -b android-9.0.0_r10</span>
<span class="err">git clone https://gitlab.collabora.com/spurv/android_manifest.git .repo/local_manifests/</span>
<span class="err">repo sync -j15</span>
<span class="err">. build/envsetup.sh</span>
<span class="err">lunch spurv-eng</span>
<span class="err">make -j12</span>
<span class="err">cd ..</span>
</code></pre></div>

<h3>Build Linux Kernel</h3>
<div class="highlight"><pre><span></span><code><span class="err">git clone https://gitlab.collabora.com/spurv/linux.git -b android-container_v5.1-rc5</span>
<span class="err">cd linux</span>
<span class="err">sh ../android/device/freedesktop/spurv/build-kernel.sh</span>
<span class="err">cd ..</span>
</code></pre></div>

<h3>Create root filesystem</h3>
<p>Just a kernel does not make an OS, so we're using Debian as a base.<br>
The way we're going to create the root filesystem is using <a href="https://github.com/go-debos/debos">debos</a>,
which is a tool for creating Debian based OS images.</p>
<h3>Create &amp; flash image</h3>
<p>Now we're ready to integrate all of the above into one coherent image.
This is where the Nitrogen6_MAX devboard targeting comes in.  </p>
<div class="highlight"><pre><span></span><code><span class="err">git clone https://gitlab.collabora.com/spurv/debos.git</span>
<span class="err">sudo debos/build_image.sh -b /dev/mmcblk0</span>
</code></pre></div>

<p>The platform specific parts are contained in <a href="https://gitlab.collabora.com/spurv/debos/blob/master/uboot_nitrogen6qp-max.scr">uboot_nitrogen6qp-max.scr</a>
and <a href="https://gitlab.collabora.com/spurv/debos/blob/master/build_image.sh">build_image.sh</a>.</p>
<h2>Boot!</h2>
<p>Pop the flashed SD-card into your device and restart it, and then log in as
<code>root/root</code>.</p>
<p>In order to start Android, run one of these two commands:</p>
<div class="highlight"><pre><span></span><code><span class="err"># Launch just and Android application</span>
<span class="err">/home/aosp/run.sh</span>
</code></pre></div>

<p>Starting the Android application might take a minute or two, but Weston should
start immediately.</p>
<h2>Acknowledgments</h2>
<p>A lot of different contributors enabled this work, both directly and indirectly.</p>
<ul>
<li>Boundary Devices</li>
<li>Pengutronix</li>
<li>Zodiac</li>
</ul>
<p>This post has been a part of work undertaken by my employer <a href="http://www.collabora.com">Collabora</a>.</p>
		</article>
		<section id="teaser-section">
			<div id="teaser">
				<p>Tags:
					<a href="https://memcpy.io/tag/linux.html">linux </a>
					<span id="breakdot">&middot; </span>
					<a href="https://memcpy.io/tag/open-source.html">open source </a>
					<span id="breakdot">&middot; </span>
					<a href="https://memcpy.io/tag/graphics.html">graphics </a>
					<span id="breakdot">&middot; </span>
					<a href="https://memcpy.io/tag/wayland.html">wayland </a>
					<span id="breakdot">&middot; </span>
					<a href="https://memcpy.io/tag/android.html">android </a>
					<span id="breakdot">&middot; </span>
					<a href="https://memcpy.io/tag/3d.html">3d </a>
					<span id="breakdot">&middot; </span>
					<a href="https://memcpy.io/tag/acceleration.html">acceleration </a>
					<span id="breakdot">&middot; </span>
					<a href="https://memcpy.io/tag/imx6.html">imx6 </a>
					<span id="breakdot">&middot; </span>
					<a href="https://memcpy.io/tag/nitrogen6.html">nitrogen6 </a>
				</p>
			</div>
		</section>
		<footer>
			<div id="footer">
				<p id="notices" class="smcp">
					<a href="/about.html">About</a>
					<span id="breakdot">&middot;</span>
					<a href="/index.html">Blog</a>
					<span id="breakdot">&middot;</span>
					<a href="/talks.html">Talks</a>
					<span id="breakdot">&middot;</span>
					<a href="/contact.html">Contact</a>
					<span id="breakdot">&middot;</span>
					<a href="https://github.com/robertfoss">GitHub</a>
					<br>
					<a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">Copyleft</a>
					<span id="breakdot">&middot;</span>
					2021 Robert Foss
					<span id="breakdot">&middot;</span>
					<a href="https://github.com/robertfoss/memcpy.io">Source</a>
					<br>
					<a href="/"><img src="/logo.svg"></a>
				</p>
			</div>
		</footer>
	</body>
</html>