<!DOCTYPE html>
<html>
	<head>
		<title>memcpy.io | Setting up a ChromiumOS dev environment</title>
		<link rel="icon" type="image/png" href="/favicon.png" />
		<link rel="stylesheet" type="text/css" href="/theme/css/fonts.css">
		<link rel="stylesheet" type="text/css" href="/theme/css/math.css">
		<link href="https://fonts.googleapis.com/css?family=Maven+Pro" rel="stylesheet">
		<link rel="canonical" href="https://memcpy.io/setting-up-a-chromiumos-dev-environment.html">
		<link rel="stylesheet" type="text/css" href="/theme/css/page.css">
		<meta charset="utf-8">
		<meta name="robots" content="index,follow">
		<meta name="viewport" content="width=device-width, initial-scale=1"> <!-- TODO: is this still required in 2015? -->
		<meta name="description" content="Set up environment export DEV_DIR=&#34;/opt&#34; mkdir -p $DEV_DIR export CHROMIUM_DIR=&#34;$DEV_DIR/chromiumos&#34; mkdir -p $CHROMIUM_DIR export PATH=&#34;$DEV_DIR/depot_tools:$PATH&#34; # The BOARD variable used here is specific for the Chromebook that is # being targeted, a more generic target like &#34;amd64-generic&#34; could # be more useful for you needs. export BOARD=chell # The USB_DEVICE variable refers to the USB device that will be used # for flashing ChromiumOS onto a Chromebook. # Make sure that this device does not contain anything important! export USB_DEVICE=&#34;/dev/sda&#34; Install dependencies sudo apt install git-core gitk git-gui subversion curl cd $DEV_DIR git clone https://chromium.googlesource.com/chromium/tools/depot_tools.git Get ChromiumOS source cd ${CHROMIUM_DIR} repo init -u https://chromium.googlesource.com/chromiumos/manifest.git repo sync -j25 Build ChromiumOS â€¦">
		<meta name="author" content="Robert Foss">
		<meta name="keywords" content="Robert Foss memcpy Robert Foss, Open Source, Software, Linux, Embedded, Engineer, linux, chromiumos, chromebook, collabora">
		<meta property="og:title" content="Setting up a ChromiumOS dev environment" />
		<meta property="og:type" content="article" />
		<meta property="og:url" content="https://memcpy.io/setting-up-a-chromiumos-dev-environment.html" />
		<meta property="og:locale" content="" />
		<meta property="og:site_name" content="memcpy.io" />
		<meta property="article:published_time" content="2017-02-16" />
		<meta property="article:section" content="chromiumos" />
		<meta property="article:tag" content="linux" />
		<meta property="article:tag" content="chromiumos" />
		<meta property="article:tag" content="chromebook" />
		<meta property="article:tag" content="collabora" />
		<meta name="twitter:card" content="summary_large_image" />
		<meta name="twitter:creator" content="@memcpy_io" />
		<meta name="twitter:site" content="@memcpy_io" />
		<meta name="twitter:title" content="Setting up a ChromiumOS dev environment" />
		<meta name="twitter:description" content="Setting up a fully functional ChromiumOS development environment on actual Chromebook hardware" />
	</head>
	<body>
		<article id="content" itemscope>
			<header>
				<h1>Setting up a ChromiumOS dev environment</h1>
				<p>
				Published <time datetime="2017-02-16" itemprop="datePublished">2017-02-16</time>
				</p>
			</header>
			<p>Setting up a fully functional ChromiumOS development environment on actual Chromebook hardware</p>
			<h2>Set up environment</h2>
<div class="highlight"><pre><span></span><code><span class="n">export</span> <span class="n">DEV_DIR</span><span class="o">=</span><span class="ss">&quot;/opt&quot;</span>
<span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="err">$</span><span class="n">DEV_DIR</span>
<span class="n">export</span> <span class="n">CHROMIUM_DIR</span><span class="o">=</span><span class="ss">&quot;$DEV_DIR/chromiumos&quot;</span>
<span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="err">$</span><span class="n">CHROMIUM_DIR</span>
<span class="n">export</span> <span class="n">PATH</span><span class="o">=</span><span class="ss">&quot;$DEV_DIR/depot_tools:$PATH&quot;</span>

<span class="o">#</span> <span class="n">The</span> <span class="n">BOARD</span> <span class="k">variable</span> <span class="n">used</span> <span class="n">here</span> <span class="k">is</span> <span class="k">specific</span> <span class="k">for</span> <span class="n">the</span> <span class="n">Chromebook</span> <span class="n">that</span> <span class="k">is</span>
<span class="o">#</span> <span class="n">being</span> <span class="n">targeted</span><span class="p">,</span> <span class="n">a</span> <span class="k">more</span> <span class="n">generic</span> <span class="n">target</span> <span class="k">like</span> <span class="ss">&quot;amd64-generic&quot;</span> <span class="n">could</span>
<span class="o">#</span> <span class="n">be</span> <span class="k">more</span> <span class="n">useful</span> <span class="k">for</span> <span class="n">you</span> <span class="n">needs</span><span class="p">.</span>
<span class="n">export</span> <span class="n">BOARD</span><span class="o">=</span><span class="n">chell</span>

<span class="o">#</span> <span class="n">The</span> <span class="n">USB_DEVICE</span> <span class="k">variable</span> <span class="n">refers</span> <span class="k">to</span> <span class="n">the</span> <span class="n">USB</span> <span class="n">device</span> <span class="n">that</span> <span class="n">will</span> <span class="n">be</span> <span class="n">used</span>
<span class="o">#</span> <span class="k">for</span> <span class="n">flashing</span> <span class="n">ChromiumOS</span> <span class="n">onto</span> <span class="n">a</span> <span class="n">Chromebook</span><span class="p">.</span>
<span class="o">#</span> <span class="n">Make</span> <span class="n">sure</span> <span class="n">that</span> <span class="n">this</span> <span class="n">device</span> <span class="n">does</span> <span class="k">not</span> <span class="n">contain</span> <span class="n">anything</span> <span class="n">important</span><span class="o">!</span>
<span class="n">export</span> <span class="n">USB_DEVICE</span><span class="o">=</span><span class="ss">&quot;/dev/sda&quot;</span>
</code></pre></div>

<h2>Install dependencies</h2>
<div class="highlight"><pre><span></span><code><span class="err">sudo apt install git-core gitk git-gui subversion curl</span>
<span class="err">cd $DEV_DIR</span>
<span class="err">git clone https://chromium.googlesource.com/chromium/tools/depot_tools.git</span>
</code></pre></div>

<h2>Get ChromiumOS source</h2>
<div class="highlight"><pre><span></span><code>cd <span class="cp">${</span><span class="n">CHROMIUM_DIR</span><span class="cp">}</span>
repo init -u https://chromium.googlesource.com/chromiumos/manifest.git
repo sync -j25
</code></pre></div>

<h2>Build ChromiumOS</h2>
<div class="highlight"><pre><span></span><code>cros_sdk -- ./build_packages --board=<span class="cp">${</span><span class="n">BOARD</span><span class="cp">}</span>
cros_sdk -- ./build_image --board=<span class="cp">${</span><span class="n">BOARD</span><span class="cp">}</span>
</code></pre></div>

<h2>Flash ChromiumOS to storage medium</h2>
<div class="highlight"><pre><span></span><code>cros_sdk -- cros flash --board=<span class="cp">${</span><span class="n">BOARD</span><span class="cp">}</span> usb:/<span class="nv">$USB_DEVICE</span>
</code></pre></div>

<h2>Install ChromiumOS on Chromebook</h2>
<h3>Enter Chromebook into dev-mode</h3>
<p>This part is highly device specific, and depends on how the manufacturer of your device has chosen
to implement the dev-mode switch.</p>
<p>A partial list of devices and how to enter them into dev-mode can be found <a href="https://www.chromium.org/chromium-os/developer-information-for-chrome-os-devices">here</a>.</p>
<h3>Flash ChromiumOS to Chromebook</h3>
<p>Fire up your Chrombook device and hit Ctrl+Alt+Back, followed by 'chronos' and hit enter.
Followed by the below command to install the ChromiumOS build that was just flashed.</p>
<div class="highlight"><pre><span></span><code><span class="err">/usr/sbin/chromeos-install</span>
</code></pre></div>

<h2>Debug an application</h2>
<h3>On Chromebook</h3>
<p>Again fire up your Chrombook device and hit Ctrl+Alt+Back, followed by 'chronos' and hit enter.</p>
<div class="highlight"><pre><span></span><code><span class="o">#</span> <span class="n">Remount</span> <span class="n">the</span> <span class="n">root</span> <span class="n">drive</span> <span class="k">read</span> <span class="o">/</span> <span class="k">write</span>
<span class="n">sudo</span> <span class="n">mount</span> <span class="o">-</span><span class="n">o</span> <span class="n">remount</span><span class="p">,</span><span class="n">rw</span> <span class="o">/</span>

<span class="o">#</span> <span class="k">Open</span> <span class="n">port</span> <span class="n">so</span> <span class="n">that</span> <span class="n">gdbserver</span> <span class="n">can</span> <span class="n">be</span> <span class="n">reached</span>
<span class="n">sudo</span> <span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">iptables</span> <span class="o">-</span><span class="n">A</span> <span class="k">INPUT</span>  <span class="o">-</span><span class="n">p</span> <span class="n">tcp</span> <span class="c1">--dport 1234 -j ACCEPT</span>

<span class="o">#</span> <span class="n">Run</span> <span class="n">gdb</span> <span class="n">server</span><span class="p">,</span> <span class="n">listening</span> <span class="k">on</span> <span class="n">port</span> <span class="mi">1234</span> <span class="p">(</span><span class="n">opened</span> <span class="k">in</span> <span class="n">iptables</span> <span class="n">command</span> <span class="n">above</span><span class="p">)</span>
<span class="n">sudo</span> <span class="n">gdbserver</span> <span class="p">:</span><span class="mi">1234</span> <span class="n">chrome</span>
</code></pre></div>

<h3>On dev machine</h3>
<div class="highlight"><pre><span></span><code><span class="o">#</span> <span class="k">On</span> <span class="n">x86</span>
<span class="n">cros_sdk</span> <span class="c1">-- sudo USE=expat emerge cross-i686-pc-linux-gnu/gdb</span>
<span class="o">#</span> <span class="k">On</span> <span class="n">ARMv7</span>
<span class="n">cros_sdk</span> <span class="c1">-- sudo USE=expat emerge cross-armv7a-cros-linux-gnueabi/gdb</span>

<span class="n">cros_sdk</span> <span class="c1">-- i686-pc-linux-gnu-gdb &quot;/build/$BOARD/opt/google/chrome/chrome&quot;</span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="k">set</span> <span class="n">sysroot</span> <span class="o">/</span><span class="n">build</span><span class="o">/</span><span class="err">$</span><span class="n">BOARD</span><span class="o">/</span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="n">target</span> <span class="n">remote</span> <span class="n">IP_ADDR_CHROMEBOOK</span><span class="p">:</span><span class="mi">1234</span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="k">continue</span>
</code></pre></div>

<h2>Conclusion</h2>
<p>This is a bit of a rough outline, and is only suitable for Chromebook devices that already are in dev-mode.</p>
<h2>Thanks</h2>
<p>This post has been a part of work undertaken by my employer <a href="http://www.collabora.com">Collabora</a>.</p>
<h2>References</h2>
<p><a href="http://dev.chromium.org/developers/how-tos/install-depot-tools">ChromiumOS Depo Tools</a><br>
<a href="https://www.chromium.org/chromium-os/quick-start-guide">ChromiumOS Quick Start</a><br>
<a href="https://www.chromium.org/chromium-os/developer-information-for-chrome-os-devices">ChromiumOS Dev Mode</a><br>
<a href="https://www.chromium.org/chromium-os/how-tos-and-troubleshooting/debugging-tips">ChromiumOS Debug</a></p>
		</article>
		<section id="teaser-section">
			<div id="teaser">
				<p>Tags:
					<a href="https://memcpy.io/tag/linux.html">linux </a>
					<span id="breakdot">&middot; </span>
					<a href="https://memcpy.io/tag/chromiumos.html">chromiumos </a>
					<span id="breakdot">&middot; </span>
					<a href="https://memcpy.io/tag/chromebook.html">chromebook </a>
					<span id="breakdot">&middot; </span>
					<a href="https://memcpy.io/tag/collabora.html">collabora </a>
				</p>
			</div>
		</section>
		<footer>
			<div id="footer">
				<p id="notices" class="smcp">
					<a href="/about.html">About</a>
					<span id="breakdot">&middot;</span>
					<a href="/index.html">Blog</a>
					<span id="breakdot">&middot;</span>
					<a href="/talks.html">Talks</a>
					<span id="breakdot">&middot;</span>
					<a href="/contact.html">Contact</a>
					<span id="breakdot">&middot;</span>
					<a href="https://github.com/robertfoss">GitHub</a>
					<br>
					<a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">Copyleft</a>
					<span id="breakdot">&middot;</span>
					2021 Robert Foss
					<span id="breakdot">&middot;</span>
					<a href="https://github.com/robertfoss/memcpy.io">Source</a>
					<br>
					<a href="/"><img src="/logo.svg"></a>
				</p>
			</div>
		</footer>
	</body>
</html>