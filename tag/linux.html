<!DOCTYPE html>
<html lang="en">
<head>
	<link rel="stylesheet" type="text/css" href="../theme/css/style.css">
	<!--<link rel="stylesheet/less" type="text/css" href="/theme/css/style.less">-->
	<!--<script src="/theme/js/less.js" type="text/javascript"></script>-->
	<link rel="stylesheet" type="text/css" href="../theme/css/pygments.css">
	<link href='http://fonts.googleapis.com/css?family=Open+Sans:800,400,300|Inconsolata' rel='stylesheet' type='text/css'>
	<link rel="icon" type="image/png" href="logo.png" />

	<link href="http://memcpy.io/" type="application/atom+xml" rel="alternate" title="memcpy.io ATOM Feed" />


	<title>memcpy.io</title>
	<meta charset="utf-8" />
</head>
<body>
	<section id="sidebar">
		<div id="menu">
			<a href="/">
				<img type="image/png" src="../logo.png" width="155">
			</a>

			<h1>memcpy.io</h1>
			<h2>Projects, hacks and engineering</h2>
			<ul>
					<li><a href="about-me.html">About</a></li>
					<li><a href="contracting.html">Contracting</a></li>
					<li><a href="https://github.com/robertfoss">GitHub</a></li>
					<li><a href="archives.html">Previous posts</a></li>
			</ul>
		</div>
	</section>

	<section id="posts">

		<article>
			<h1 class="title">
				<a href="../building-android-for-qemu.html" rel="bookmark" title="Permalink to Building Android for Qemu">Building Android for Qemu</a>
			</h1>
			<abbr class="published" title="2016-08-30T15:22:00+02:00">Tue 30 August 2016</abbr>
		<div class="entry-content"> <p><img alt="Alt text" src="images/2016-08-30_android_qemu.png" title="Android running on Qemu" /></p>
<p>Developing Linux for Android on Qemu allows you to do some things that are
not necessarily possible using the stock emulator.
For my purposes I need access to a GPU and be able to modify the driver, which
is where Virgilrenderer and Qemu comes in handy.</p>
<p>The guide below helps you compile Android and run it on top of Qemu with
Mesa/Virgilrenderer supplying a virtual GPU.
Because of this, the following guide is aimed at Linux hosts.</p>
<p>This guide is based on Rob Herrings <a href="https://github.com/robherring/generic_device/wiki/KConfig-based-Multi-platform-Android-Device-(and-Mesa-graphics)">fantastic guide</a>, but has
been slightly streamlined and had physical hardware support stripped out.</p>
<h2>Install dependencies</h2>
<p>These dependencies were available on Ubuntu 16.04, some alternative packages
might be needed for other distributions.</p>
<div class="highlight"><pre>sudo apt install autoconf gcc-aarch64-linux-gnu libaio-dev libbluetooth-dev ...</pre></div> </div>
		</article>
		<article>
			<h1 class="title">
				<a href="../ethernet-device-stress-testing.html" rel="bookmark" title="Permalink to Ethernet device stress testing">Ethernet device stress testing</a>
			</h1>
			<abbr class="published" title="2016-08-25T13:05:00+02:00">Thu 25 August 2016</abbr>
		<div class="entry-content"> <p><img alt="Alt text" src="images/2016-08-25_ethernet_device_testing.png" title="Screenshot of python script" /></p>
<p>During testing of power management patches for usb ethernet dongles, a script
was needed to stress test connecting/disconnecting/reconnecting these devices.</p>
<p>Luckily a script like that already exists as a part of the chromiumos project,
and can be found <a href="https://chromium.googlesource.com/chromiumos/third_party/autotest/+/HEAD/client/site_tests/network_EthernetStressPlug/network_EthernetStressPlug.py">here</a>.</p>
<p>That script does however not run standalone and requires a remote device
(chromebook) to execute on. So I took the liberty of changing it to support
local testing. The modified version can be found <a href="files/2016-08-25/network_EthernetStressPlug.py">here</a>.</p>
<p>This might come in handy for someone, if not, the script will at least be
archived on this site.</p>
<h2>Example</h2>
<div class="highlight"><pre>$ sudo pip2.7 install autotest
$ ip link
1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu <span class="m">65536</span> qdisc noqueue state UNKNOWN mode DEFAULT group default qlen 1
    link/loopback 00:00:00 ...</pre></div> </div>
		</article>
		<article>
			<h1 class="title">
				<a href="../linux-kernel-development-shell-scripts.html" rel="bookmark" title="Permalink to Linux kernel development shell scripts">Linux kernel development shell scripts</a>
			</h1>
			<abbr class="published" title="2016-07-26T10:32:00+02:00">Tue 26 July 2016</abbr>
		<div class="entry-content"> <p><img alt="Alt text" src="images/2016-07-26_linux_development_helper_script.png" title="Terminal screenshot of scripts in use" /></p>
<p>While upstreaming kernel patches scripts/checkpatch.pl and scripts/get_maintainer.pl
often come in handy.
But to me the interface they provide is slightly bulky and rely
on using patch files instead of git commits, which to me is a bit inconvenient.</p>
<p>These scripts are all meant to be included in <strong>.bashrc</strong> or <strong>.zshrc</strong></p>
<h2>scripts/checkpatch.pl helper</h2>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span class="ch">#!/bin/bash</span>
<span class="k">function</span> checkpatch <span class="o">{</span>
  <span class="k">if</span> <span class="o">[</span> -z <span class="si">${</span><span class="nv">1</span><span class="p">+x</span><span class="si">}</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nb">exec</span> git diff <span class="p">|</span> scripts/checkpatch.pl --no-signoff -q -
  <span class="k">elif</span> <span class="o">[[</span> <span class="nv">$1</span> <span class="o">==</span> *<span class="s2">&quot;cache&quot;</span>* <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nb">exec</span> git diff --cached <span class="p">|</span> scripts/checkpatch.pl --no-signoff -q -
  <span class="k">else</span>
    <span class="nv">NUM_COMMITS</span><span class="o">=</span><span class="nv">$1</span>
    <span class="nb">exec</span> git diff HEAD~$NUM_COMMITS..HEAD <span class="p">|</span> scripts/checkpatch.pl --no-signoff -q -
  <span class="k">fi</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>

<p>The checkpatch script simple wraps the patch creation process and allows ...</p> </div>
		</article>

<p class="paginator">
</p>
	</section>

</body>
</html>